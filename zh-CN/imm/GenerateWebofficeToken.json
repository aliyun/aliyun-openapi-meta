{
  "name": "GenerateWebofficeToken",
  "deprecated": false,
  "protocol": "HTTP|HTTPS",
  "method": "GET|POST",
  "pathPattern": "",
  "parameters": [
    {
      "name": "CachePreview",
      "description": "缓存预览标识：\n\n-  true：开启后，文档预览时将不再更新协同编辑内容，适用于仅预览的场景。\n-  false：关闭时，默认采用协同预览，及预览时候可以同步更新协同编辑内容。\n\n><notice>缓存预览和非缓存预览的单价不同，详情请查看计费项说明。\n</notice>><notice>缓存预览时不支持文档内容搜索，不支持打印。</notice>\n<notice>缓存预览暂不支持更新缓存内容。</notice>",
      "position": "Query",
      "type": "Boolean",
      "required": false
    },
    {
      "name": "CredentialConfig",
      "description": "**如无特殊需求，请保持留空即可。**\n\n链式授权配置，非必填。更多信息，请参见[使用链式授权访问其他实体资源](~~465340~~)。",
      "position": "Query",
      "type": "Json",
      "required": false
    },
    {
      "name": "ExternalUploaded",
      "description": "OSS上传同名文件是否是预期行为。可取值如下：\n\n- true：OSS上传同名文件是预期行为，上传的文档将覆盖原文档生成新版本。在设置为 true 后，仍需先关闭当前正在编辑的文档，然后等待约5分钟后重新打开，才能加载新的文档。仅当文档处于关闭状态时上传才有效，文档处于打开状态时，新的保存会覆盖掉上传的文件。\n- false（默认）：OSS上传同名文件不是预期行为，该接口会返回错误。",
      "position": "Query",
      "type": "Boolean",
      "required": false
    },
    {
      "name": "Filename",
      "description": "文件名称，必须包含文件扩展名。默认为参数**SourceURI**的最后一级。\n\n支持的文件扩展名（其中PDF只支持预览）：\n\n- 文字文档（Word）：doc、docx、txt、dot、wps、wpt、dotx、docm、dotm、rtf\n- 演示文档（PPT）：ppt、pptx、pptm、ppsx、ppsm、pps、potx、potm、dpt、dps\n- 表格文档（Excel）：et、xls、xlt、xlsx、xlsm、xltx、xltm、csv\n- PDF 文档：pdf",
      "position": "Query",
      "type": "String",
      "required": false
    },
    {
      "name": "Hidecmb",
      "description": "是否隐藏工具栏，文档预览模式下支持设置此参数。可取值如下：\n\n- false（默认）：不隐藏工具栏。\n\n- true：隐藏工具栏。",
      "position": "Query",
      "type": "Boolean",
      "required": false
    },
    {
      "name": "Notification",
      "description": "Notification 消息通知配置，目前仅支持MNS，异步通知消息格式请参考[WebOffice消息通知格式](~~2743999~~)。\n\n> 文件保存和文件重命名时会有消息通知。",
      "position": "Query",
      "type": "Json",
      "required": false
    },
    {
      "name": "NotifyTopicName",
      "description": "支持将一些事件以 MNS 消息的方式通知给客户。该参数为 MNS 异步消息通知的 topic。",
      "position": "Query",
      "type": "String",
      "required": false
    },
    {
      "name": "Password",
      "description": "文档的打开密码。\n>如果需要预览或编辑有密码的文档，请设置此参数。",
      "position": "Query",
      "type": "String",
      "required": false
    },
    {
      "name": "Permission",
      "description": "用户权限信息，以JSON格式表示。\n\n用户权限包括如下选项：\n\n每个选项的类型均为Boolean，默认值均为false，可选值为true和false。\n\n- Readonly（可选）：预览模式。\n\n- Rename（可选）：重命名文件权限，只提供消息通知功能，重命名事件会发送到MNS中。\n\n- History（可选）：查看历史版本的权限。\n\n- Copy（可选）：拷贝权限。\n\n- Export（可选）：导出PDF权限。\n\n- Print（可选）：打印权限。\n\n\n>PDF仅支持预览功能，因此必须将” Readonly“参数设置为true。\n>\n\n>PDF文件不支持导出。\n> \n\n> 若要使用多版本功能，必须先在OSS中开通多版本功能，然后将 ”History“参数设置为true。\n>\n><notice>缓存预览时不支持打印。></notice>\n><notice>编辑模式可以查看历史版本，预览模式不支持查看历史版本。></notice>",
      "position": "Query",
      "type": "Json",
      "required": false
    },
    {
      "name": "PreviewPages",
      "description": "限制只能预览前几页，默认不限制。最大不能超过5000",
      "position": "Query",
      "type": "Long",
      "required": false
    },
    {
      "name": "ProjectName",
      "description": "项目名称，获取方式请参见[创建项目](~~478153~~)。",
      "position": "Query",
      "type": "String",
      "required": true
    },
    {
      "name": "Referer",
      "description": "OSS防盗链。IMM需要从OSS中获取源文件，如果OSS进行了防盗链设置，IMM需要将对应的头部传给OSS才能获取源文件。\n> 如果访问文档所在的Bucket设置了Referer，请设置此参数。",
      "position": "Query",
      "type": "String",
      "required": false
    },
    {
      "name": "SourceURI",
      "description": "待预览或编辑文档的OSS地址。\n\nOSS地址规则为`oss://${Bucket}/${Object}`，其中`Bucket`为和当前项目处于同一地域的OSS Bucket名称，`Object`为包含文件扩展名的文件完整路径。",
      "position": "Query",
      "type": "String",
      "required": true
    },
    {
      "name": "User",
      "description": "用户信息。可传入业务侧的用户信息，WebOffice 页面将显示该信息。\n\n系统通过 User.Id 区分不同用户，User.Name 仅用于前端展示。如果未传入 User.Id，后端将自动生成一个随机 ID。不同 ID 的用户视为不同主体，无法互相修改或删除评论。\n\n默认格式为：Unknown_随机字符串。若未传入User.Id，用户信息将默认显示为 \"Unknown\"。",
      "position": "Query",
      "type": "Json",
      "required": false
    },
    {
      "name": "UserData",
      "description": "用户自定义信息，必须填写Notification参数传入MNS配置时才能生效，在异步消息通知中会为您返回，用于方便您系统内对消息通知进行关联处理。最大长度为2048字节。",
      "position": "Query",
      "type": "String",
      "required": false
    },
    {
      "name": "Watermark",
      "description": "水印信息。该水印在前端生成，并没有写入到源文档中，同一个文档传入不同的参数会得到不同的水印。",
      "position": "Query",
      "type": "Json",
      "required": false
    }
  ]
}