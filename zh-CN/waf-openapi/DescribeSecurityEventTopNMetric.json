{
  "name": "DescribeSecurityEventTopNMetric",
  "protocol": "HTTPS",
  "method": "GET|POST",
  "pathPattern": "",
  "parameters": [
    {
      "name": "Filter",
      "description": "查询过滤条件，多个过滤条件之间是逻辑与的关系。",
      "position": "Query",
      "type": "String",
      "required": true
    },
    {
      "name": "InstanceId",
      "description": "WAF实例的ID。\n\n> 您可以调用[DescribeInstance](~~433756~~)查询当前WAF实例的ID。",
      "position": "Query",
      "type": "String",
      "required": true
    },
    {
      "name": "Limit",
      "description": "控制统计数据按照降序排序后返回数据条数，最大值为10。",
      "position": "Query",
      "type": "Long",
      "required": true
    },
    {
      "name": "Metric",
      "description": "用于区分返回的数据内容，不同的Metric对应不同的数据内容，该接口支持的Metric如下：\n> “攻击请求”的定义参见API接口描述，下面的描述中引用该概念\n\n- real_client_ip，把攻击请求的源IP聚合统计并降序排序后，返回前N条数据\n- http_user_agent，把攻击请求的User-Agent聚合统计并按照降序排序后，返回前N条数据\n- matched_host，把攻击请求命中的防护对象聚合统计并按照降序排序后，返回前N条数据\n- remote_region_id，把攻击请求的源IP所属的国家聚合统计并降序排序后，返回前N条数据\n- request_path，把攻击请求的URL（不包含query）聚合统计并按照降序排序后，返回前N条数据\n- block_defense_scene，把拦截请求（处置动作为非“观察”）的最终处置模块聚合统计并按照降序排序后，返回前N条数据\n- defense_scene，把攻击请求命中的所有防护模块进行聚合统计并按照降序排序后，返回前N条数据\n- defense_scene_rule_id，查询命中的非观察规则的top rule id以及规则对应的防护模块。该查询只返回非观察模式规则的统计。返回数据格式如下：<br>\n `{ \"Attribute\": \"waf_base\", \"Value\": 140, \"Name\": \"111034\" }`\n- defense_scene_with_rule_id，返回命中请求数排名前N的规则id以及规则所属防护模块，使用“-”连接。该查询不区分规则动作，包含了观察规则和拦截规则。返回格式如下所示：<br>\n `{ \"Attribute\": \"\",  \"Value\": 1,  \"Name\": \"120075-waf_base\" }`\n- defense_scene_top_rule_id，查询某个防护模块的top命中规则，需要在Filter的Conditions字段指定过滤条件，比如查询\"自定义acl\"模块的top命中规则，Conditions字段格式如下：<br>\n   `{ \"Key\": \"defense_scene_map\", \"OpValue\": \"contain\", \"Values\": \"custom_acl\" }`\n- defense_scene_rule_type，查询web核心防护模块的top命中规则类型，只有Web核心防护模块支持该查询，因为只有Web核心防护有规则子类型。查询时需要在Filter的Conditions字段指定过滤条件。格式如下：<br>\n`    { \"Key\": \"defense_scene\", \"OpValue\": \"eq\", \"Values\": \"waf_base\" }`",
      "position": "Query",
      "type": "String",
      "required": true
    },
    {
      "name": "RegionId",
      "description": "WAF实例所属地域。取值：\n\n- **cn-hangzhou**：表示中国内地。\n- **ap-southeast-1**：表示非中国内地。",
      "position": "Query",
      "type": "String",
      "required": false
    },
    {
      "name": "ResourceManagerResourceGroupId",
      "description": "阿里云资源组ID。",
      "position": "Query",
      "type": "String",
      "required": false
    }
  ]
}